


    <div class="card"> 
        <div class="card-header">
            <strong>{{'TaskForm' | translate}}</strong>
        </div>
        <div class="card-body">
            <form [formGroup]="taskForm">
              <ng-container formArrayName="tasks">
                <section class="col-md-10 categories-grid"  *ngFor="let task of tasks().controls; let taskIndex=index">
                    <div class="row">
                        <ng-container [formGroupName]="taskIndex">
                          <div class="counter">
                            <strong>{{taskIndex+1}}</strong>
                          </div>
                          <div class="col-md-9 my-1">
                            <label for=""> <em class="text-danger">*</em>{{'Title' | translate}}</label>
                            <input type="text" formControlName="taskTitle" class="form-control">
                        </div>
                        <div class="col-md-3 buttons">
                          <mat-icon (click)="addTask()" class="addIcon">add_circle</mat-icon> 
                    
                          <mat-icon  (click)="deleteTask(taskIndex)" [class.disabled]="task.value.id !== null" class="deleteIcon">delete_forever</mat-icon>
      
                        </div>
               
                        <div class="col-md-6 my-1">
                            <label for="project">{{'Project' | translate}}</label>
                            <select class="form-control" name="project" id="project" formControlName="project">
                                <option value="" disabled selected hidden>{{'select' | translate}}</option>
                                <option [value]="item.id" *ngFor="let item of projects">{{item.projectName}}</option>
                            </select>
                     
                        </div>    
                        <div class="col-md-6 my-1">
                            <label for="type"><em class="text-danger">*</em> {{'Type' | translate}}</label>
                            <select class="form-control" name="type" id="type" formControlName="type">
                                <option value="" disabled selected hidden>{{'select' | translate}}</option>
                                <option [value]="item.id" *ngFor="let item of types">{{item.lookupDetailName}}</option>
                            </select>
                     
                        </div>    
                        <div class="col-md-6 my-1">
                            <label for="currency"> <em class="text-danger">*</em> {{'Currency' | translate}}</label>
                            <select class="form-control" name="currency" id="currency" formControlName="currency">
                                <option value="" disabled selected hidden>{{'select' | translate}}</option>
                                <option [value]="item.id" *ngFor="let item of currencies">{{item.lookupDetailName}}</option>
                            </select>
                     
                        </div>    
                        <div class="col-md-6 my-1">
                            <label for="price"> <em class="text-danger">*</em> {{'Price' | translate}}</label>
                            <input type="number" class="form-control" name="price" id="price" formControlName="price">
                        </div>    
                        <div class="col-md-12 my-1">
                          <label for="assignedTo">{{'AssignedTo' | translate}}</label>
                          <select class="form-control" name="assignedTo" id="assignedTo" formControlName="assignedTo">
                              <option value="" disabled selected hidden>{{'select' | translate}}</option>
                              <option [value]="item.id" *ngFor="let item of projects">{{item.projectName}}</option>
                          </select>
                        </div>   
                        <div class="col-md-6 my-1">
                             <mat-form-field appearance="fill">
                              <mat-label><em class="text-danger">*</em> Start date</mat-label>
                              <input matInput [matDatepicker]="startDate" formControlName="startDate" 
                              [min]="getToday()" [max]="task.value.endDate">
                              <mat-datepicker-toggle matSuffix [for]="startDate"></mat-datepicker-toggle>
                              <mat-datepicker #startDate></mat-datepicker>
                            </mat-form-field>
                        </div>    
                        <div class="col-md-6 my-1">
                            <mat-form-field appearance="fill">
                              <mat-label>End date</mat-label>
                              <input matInput [matDatepicker]="endDate" formControlName="endDate"  [min]="task.value.startDate">
                              <mat-datepicker-toggle matSuffix [for]="endDate"></mat-datepicker-toggle>
                              <mat-datepicker #endDate></mat-datepicker>
                            </mat-form-field>

                        </div>
                        <div class="col-md-12 my-1">
                          <label for="description">{{'Description' | translate}}</label>
                          <textarea placeholder="Ex. It makes me feel..."  class="form-control" id="description"
                          formControlName="description" cols="30" rows="3"></textarea>
                         </div>       
                        <div class="col-md-12 my-1">
                           <input type="file" name="files" id="files" class="form-control p-2" 
                           [disabled]="checkUploadFilesDisabled(taskIndex)" multiple
                           (change)="getFiles($event,taskIndex)" >
                         </div>       
      
                        
                        </ng-container>
                    </div>
                </section>
              </ng-container>
               <div class="form-row action-btn-container">
                <button mat-raised-button color="primary" class="w-30"
                (click)="cancel()">
                <mat-icon> cancel_presentation</mat-icon>
                {{'Cancel' | translate}}
               </button>
                <button mat-raised-button color="primary" class="w-30"
                 (click)="submitForm()" [disabled]="checkDisable()">
                 <mat-icon>add_circle</mat-icon> 
                 {{'Save' | translate}}
                </button>
            
               </div>
            </form>
        </div>
    </div>
